<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨ Logo åŒºåŸŸ -->
  <view class="header">
    <text class="header-icon">ğŸ±</text>
    <text class="header-title">çŒ«å’ªå¬å”¤å™¨</text>
    <text class="header-subtitle">ç‚¹å‡»æŒ‰é’®ï¼Œå¬å”¤ä½ çš„çŒ«å’ª~</text>
  </view>

  <!-- åˆ†ç±»æ ‡ç­¾æ  -->
  <view class="category-tabs">
    <view
      class="tab-item {{currentCategory === item.key ? 'tab-active' : ''}}"
      wx:for="{{categories}}"
      wx:key="key"
      data-category="{{item.key}}"
      bindtap="onCategoryTap"
    >
      <text class="tab-icon">{{item.icon}}</text>
      <text class="tab-name">{{item.name}}</text>
    </view>
  </view>

  <!-- æŒ‰é’®ç½‘æ ¼åŒºåŸŸ -->
  <view class="button-grid">
    <view
      class="sound-btn {{playingId === item.id ? 'sound-btn-playing' : ''}} {{item.id === lastTappedId ? 'sound-btn-tap' : ''}}"
      wx:for="{{currentList}}"
      wx:key="id"
      data-id="{{item.id}}"
      bindtap="onSoundTap"
      bindlongpress="onSoundLongPress"
    >
      <view class="btn-icon-wrap">
        <text class="btn-icon">{{item.icon}}</text>
        <!-- æ’­æ”¾ä¸­åŠ¨ç”»æŒ‡ç¤º -->
        <view class="playing-indicator" wx:if="{{playingId === item.id}}">
          <view class="wave wave1"></view>
          <view class="wave wave2"></view>
          <view class="wave wave3"></view>
        </view>
      </view>
      <text class="btn-name">{{item.name}}</text>
      <!-- æ”¶è—æ ‡è®° -->
      <view class="fav-mark" wx:if="{{favorites.includes(item.id)}}">
        <text>â¤ï¸</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ§åˆ¶åŒº -->
  <view class="control-bar">
    <!-- éšæœºæ’­æ”¾æŒ‰é’® -->
    <view class="control-btn random-btn" bindtap="onRandomPlay">
      <text class="control-icon">ğŸ²</text>
      <text class="control-text">éšæœºæ’­æ”¾</text>
    </view>

    <!-- éŸ³é‡æ§åˆ¶ -->
    <view class="volume-control">
      <text class="volume-icon">ğŸ”Š</text>
      <slider
        class="volume-slider"
        min="0"
        max="100"
        value="{{volumePercent}}"
        activeColor="#FF8C42"
        backgroundColor="#E0D5C5"
        block-size="20"
        block-color="#FF8C42"
        bindchange="onVolumeChange"
      />
    </view>
  </view>

  <!-- æµ®åŠ¨æŒ‰é’®åŒºåŸŸ -->
  <view class="float-btns">
    <!-- æ”¶è—æŒ‰é’® -->
    <view class="float-btn {{showPanel === 'favorites' ? 'float-btn-active' : ''}}" bindtap="onToggleFavorites">
      <text>â­</text>
    </view>
    <!-- å†å²æŒ‰é’® -->
    <view class="float-btn {{showPanel === 'history' ? 'float-btn-active' : ''}}" bindtap="onToggleHistory">
      <text>ğŸ“‹</text>
    </view>
  </view>

  <!-- æ”¶è—/å†å²é¢æ¿ -->
  <view class="side-panel {{showPanel ? 'side-panel-show' : ''}}" wx:if="{{showPanel}}">
    <view class="panel-mask" bindtap="onClosePanel"></view>
    <view class="panel-content">
      <view class="panel-header">
        <text class="panel-title">{{showPanel === 'favorites' ? 'æˆ‘çš„æ”¶è—' : 'æ’­æ”¾å†å²'}}</text>
        <view class="panel-close" bindtap="onClosePanel">
          <text>âœ•</text>
        </view>
      </view>
      <view class="panel-list" wx:if="{{panelList.length > 0}}">
        <view
          class="panel-item"
          wx:for="{{panelList}}"
          wx:key="id"
          data-id="{{item.id}}"
          bindtap="onPanelItemTap"
        >
          <text class="panel-item-icon">{{item.icon}}</text>
          <text class="panel-item-name">{{item.name}}</text>
          <text class="panel-item-desc">{{item.desc}}</text>
        </view>
      </view>
      <view class="panel-empty" wx:else>
        <text class="empty-icon">ğŸ˜¿</text>
        <text class="empty-text">{{showPanel === 'favorites' ? 'è¿˜æ²¡æœ‰æ”¶è—å“¦~' : 'è¿˜æ²¡æœ‰æ’­æ”¾è®°å½•~'}}</text>
      </view>
    </view>
  </view>

  <!-- é•¿æŒ‰æç¤ºå¼¹çª— -->
  <view class="tooltip {{showTooltip ? 'tooltip-show' : ''}}" wx:if="{{showTooltip}}">
    <view class="tooltip-mask" bindtap="onCloseTooltip"></view>
    <view class="tooltip-content">
      <text class="tooltip-icon">{{tooltipData.icon}}</text>
      <text class="tooltip-name">{{tooltipData.name}}</text>
      <text class="tooltip-desc">{{tooltipData.desc}}</text>
      <view class="tooltip-actions">
        <view class="tooltip-btn" bindtap="onTooltipPlay" data-id="{{tooltipData.id}}">
          <text>â–¶ï¸ æ’­æ”¾</text>
        </view>
        <view class="tooltip-btn" bindtap="onTooltipFav" data-id="{{tooltipData.id}}">
          <text>{{favorites.includes(tooltipData.id) ? 'ğŸ’” å–æ¶ˆæ”¶è—' : 'â¤ï¸ æ”¶è—'}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
